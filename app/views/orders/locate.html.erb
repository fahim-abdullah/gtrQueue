
<section id="locate">
	<div class="container">
		<div class="col-12 jumbotron" align="center">
            <h1>Cargo Locator</h1>
            <p class="col-md-8">Once you have successfully located the cargo, please fill in the details and submit. If you find less pieces than ordered, change release type to Partial Delivery.</p>

            <div class="cargo-info col-12 col-md-6">
                <div class="jumbotron bg-success">
                <p class="text-white">AWB Number : <%= "#{@order.prefix}-#{@order.awbnum}" %></p>
                <p class="text-white">Pieces : <%= "#{@order.pieces}" %></p>
                </div>

                <%= form_for @order do |f| %>
                    <div class="form-group">
                        <label>Pieces Found</label>
                        <%= f.text_field :pieces_found, class: "form-control", required: true %>
                    </div>

                    <div class="form-group">
                        <label>Release Type : </label>
                        <button type="button" id="partial" class="btn btn-primary">Normal</button>
                        <%= f.text_field :partial_release, id: "partial-status", value: "Normal", :required => true, hidden: true %>
                    </div>
                    
                    <div class="form-group">
                        <input type="checkbox" data-toggle="toggle" data-style="ios" data-onstyle="success" data-offstyle="danger" id="located-btn">
                        <label>Shipment Located</label>
                        <%= f.text_field :located_time, id: "located-time", value: "", :required => true, hidden: true %>
                    </div>
                    <hr>
                    <%= f.submit "Update Progress", class: "btn btn-outline-primary" %>
                <% end %>
            </div>
        </div>
	</div>
</section>

<script type="text/javascript">
	$('#partial').on('click',function(){
    $(this).toggleClass('btn-dark');
    
    if ($(this).text() == "Normal"){
        $(this).text("Partial");
    } else {
        $(this).text("Normal");
    }
    
    if ($('#partial-status').val() == "Normal"){
        $('#partial-status').val("Partial");
    }
    else {
        $('#partial-status').val("Normal");
    	}
	});

	$("#located-btn").change(function() {
	    var d = new Date();
        var dateNum = d.getDate() + "/" + d.getMonth() + "/" + d.getFullYear();
	    var amOrPm = (d.getHours() < 12) ? "AM" : "PM";
	    var hour = (d.getHours() < 13) ? d.getHours() : (d.getHours() - 12);
	    var minutes = (d.getMinutes() < 10) ? "0" + d.getMinutes() : d.getMinutes();
	    var strTime = [];
        
	    if (this.checked) {
	        strTime = [hour + ':' + minutes + ' ' + amOrPm, dateNum];
	    }
	    $("#located-time").val(strTime);
	});


</script>